import angr 
import sys

def main(argv):
	p = angr.Project(argv[1])
	init = p.factory.entry_state()
	sim = p.factory.simgr(init)
	sim.explore(find=lambda s: b'correct!' in s.posix.dumps(1))

	if sim.found:
		print("\n\nHere is your flag!")
		found = sim.found[0]
		print(found.posix.dumps(sys.stdin.fileno()))

if __name__ == '__main__':
	main(sys.argv)
