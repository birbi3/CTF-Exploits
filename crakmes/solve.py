import angr
import claripy
import sys

def main():
	binaries = ['crackme01.64', 'crackme01e.64', 'crackme02.64', 'crackme02e.64', 'crackme03.64', 'crackme03e.64', 'crackme04.64', 'crackme04e.64', 'crackme05.64', 'crackme05e.64', 'crackme06.64', 'crackme06e.64', 'crackme07.64', 'crackme07e.64', 'crackme08.64', 'crackme08e.64']
	for _bin in binaries:
		p = angr.Project(_bin)
		argv1 = claripy.BVS('argv1', 40*8)
		init = p.factory.entry_state(args=["./"+_bin, argv1])
		sm = p.factory.simulation_manager(init)
		sm.explore(find=lambda s: b"Yes" in s.posix.dumps(1))
		print(" ")
		print(_bin)
		if sm.found:
			found = sm.found[0]
			solution = found.solver.eval(argv1, cast_to=bytes)
			print(found.posix.dumps(sys.stdin.fileno()))
			print(repr(solution))

if __name__ == '__main__':
	main()
